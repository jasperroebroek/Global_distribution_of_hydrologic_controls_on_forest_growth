

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mappy.raster_functions.correlate_maps module &mdash; mappy 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> mappy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">mappy.raster_functions.correlate_maps module</a></li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mappy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>mappy.raster_functions.correlate_maps module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/mappy.raster_functions.correlate_maps.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mappy.raster_functions.correlate_maps">
<span id="mappy-raster-functions-correlate-maps-module"></span><h1>mappy.raster_functions.correlate_maps module<a class="headerlink" href="#module-mappy.raster_functions.correlate_maps" title="Permalink to this headline">¶</a></h1>
<p>Algorithm to correlate two arrays (2D) with each other. All implementations here should yield an equal result.
The different functions have different scopes:
- correlate_maps_base: numpy implementation, very memory intensive as the whole rolling window array will be cast into</p>
<blockquote>
<div><p>memory. Use with care</p>
</div></blockquote>
<ul class="simple">
<li><p>_correlate_maps_full: numba implementation. Is not meant to be called directly.
It returns an output with the same size as the inputs (shape)</p></li>
<li><p>_correlate_maps_reduce: numba implementation. Is not meant to be called directly.
It reduces the output (shape/window_size)</p></li>
<li><p>_correlate_maps_input_checks: function that reuses the input checks</p></li>
<li><p>correlate_maps_njit: calls _correlate_maps_full and _correlate_maps_reduce and wraps the input checks and timing</p></li>
</ul>
<p>The Numba implementation is preferred. The user will be able to call <code class="docutils literal notranslate"><span class="pre">correlate_maps</span></code> which will either invoke
correlate_maps_base or correlate_maps_njit based on the</p>
<dl class="py function">
<dt id="mappy.raster_functions.correlate_maps._correlate_maps_full">
<code class="sig-name descname">_correlate_maps_full</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">map1</span></em>, <em class="sig-param"><span class="n">map2</span></em>, <em class="sig-param"><span class="n">window_size</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">fraction_accepted</span><span class="o">=</span><span class="default_value">0.7</span></em>, <em class="sig-param"><span class="n">reduce</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mappy/raster_functions/correlate_maps.html#_correlate_maps_full"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mappy.raster_functions.correlate_maps._correlate_maps_full" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes two maps and returning the local correlation between them with the same dimensions as the input maps.
Correlation calculated in a rolling window with the size <cite>window_size</cite>. If either of the input maps contains
a NaN value on a location, the output map will also have a NaN on that location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map1, map2</strong> (<em>array-like</em>) – Input arrays that will be correlated. If not present in dtype <cite>np.float64</cite> it will be converted internally. They
have exatly the same shape and have two dimensions.</p></li>
<li><p><strong>window_size</strong> (<em>int, optional</em>) – Size of the window used for the correlation calculations. It should be bigger than 1, the default is 5.</p></li>
<li><p><strong>fraction_accepted</strong> (<em>float, optional</em>) – Fraction of the window that has to contain not-nans for the function to calculate the correlation. The default
is 0.7.</p></li>
<li><p><strong>reduce</strong> (<em>bool, optional</em>) – Reuse all cells exactly once by setting a stepsize of the same size as window_size. The resulting map will have
the shape: shape/window_size</p></li>
<li><p><strong>verbose ; bool, optional</strong> – Times the correlation calculations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>corr</strong> – numpy array of the local correlation. If reduce is set to False, the output has the same shape as the input maps,
while if reduce is True, the output is reduce by the window size: shape//window_size.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
<p>Note that this function is not performing any input checks. Use the function correlate_maps_njit for a wrapper</p>
</p>
</dd>
</dl>
<p>around this functionality</p>
</dd></dl>

<dl class="py function">
<dt id="mappy.raster_functions.correlate_maps._correlate_maps_input_checks">
<code class="sig-name descname">_correlate_maps_input_checks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">map1</span></em>, <em class="sig-param"><span class="n">map2</span></em>, <em class="sig-param"><span class="n">window_size</span></em>, <em class="sig-param"><span class="n">fraction_accepted</span></em>, <em class="sig-param"><span class="n">reduce</span></em>, <em class="sig-param"><span class="n">verbose</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mappy/raster_functions/correlate_maps.html#_correlate_maps_input_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mappy.raster_functions.correlate_maps._correlate_maps_input_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>Input checks for correlate_maps_base and correlate_maps_njit. Check their docstring for input requirements.</p>
</dd></dl>

<dl class="py function">
<dt id="mappy.raster_functions.correlate_maps._correlate_maps_reduce">
<code class="sig-name descname">_correlate_maps_reduce</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">map1</span></em>, <em class="sig-param"><span class="n">map2</span></em>, <em class="sig-param"><span class="n">window_size</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">fraction_accepted</span><span class="o">=</span><span class="default_value">0.7</span></em>, <em class="sig-param"><span class="n">reduce</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mappy/raster_functions/correlate_maps.html#_correlate_maps_reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mappy.raster_functions.correlate_maps._correlate_maps_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes two maps and returning the local correlation between them with the same dimensions as the input maps.
Correlation calculated in a rolling window with the size <cite>window_size</cite>. If either of the input maps contains
a NaN value on a location, the output map will also have a NaN on that location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map1, map2</strong> (<em>array-like</em>) – Input arrays that will be correlated. If not present in dtype <cite>np.float64</cite> it will be converted internally. They
have exatly the same shape and have two dimensions.</p></li>
<li><p><strong>window_size</strong> (<em>int, optional</em>) – Size of the window used for the correlation calculations. It should be bigger than 1, the default is 5.</p></li>
<li><p><strong>fraction_accepted</strong> (<em>float, optional</em>) – Fraction of the window that has to contain not-nans for the function to calculate the correlation. The default
is 0.7.</p></li>
<li><p><strong>reduce</strong> (<em>bool, optional</em>) – Reuse all cells exactly once by setting a stepsize of the same size as window_size. The resulting map will have
the shape: shape/window_size</p></li>
<li><p><strong>verbose ; bool, optional</strong> – Times the correlation calculations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>corr</strong> – numpy array of the local correlation. If reduce is set to False, the output has the same shape as the input maps,
while if reduce is True, the output is reduce by the window size: shape//window_size.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
<p>Note that this function is not performing any input checks. Use the function correlate_maps_njit for a wrapper</p>
</p>
</dd>
</dl>
<p>around this functionality</p>
</dd></dl>

<dl class="py function">
<dt id="mappy.raster_functions.correlate_maps.correlate_maps">
<code class="sig-name descname">correlate_maps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">map1</span></em>, <em class="sig-param"><span class="n">map2</span></em>, <em class="sig-param"><span class="n">window_size</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">fraction_accepted</span><span class="o">=</span><span class="default_value">0.7</span></em>, <em class="sig-param"><span class="n">reduce</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mappy.raster_functions.correlate_maps.correlate_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes two maps and returning the local correlation between them with the same dimensions as the input maps.
Correlation calculated in a rolling window with the size <cite>window_size</cite>. If either of the input maps contains
a NaN value on a location, the output map will also have a NaN on that location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map1, map2</strong> (<em>array-like</em>) – Input arrays that will be correlated. If not present in dtype <cite>np.float64</cite> it will be converted internally. They
have exatly the same shape and have two dimensions.</p></li>
<li><p><strong>window_size</strong> (<em>int, optional</em>) – Size of the window used for the correlation calculations. It should be bigger than 1, the default is 5.</p></li>
<li><p><strong>fraction_accepted</strong> (<em>float, optional</em>) – Fraction of the window that has to contain not-nans for the function to calculate the correlation. The default
is 0.7.</p></li>
<li><p><strong>reduce</strong> (<em>bool, optional</em>) – Reuse all cells exactly once by setting a stepsize of the same size as window_size. The resulting map will have
the shape: shape/window_size</p></li>
<li><p><strong>verbose ; bool, optional</strong> – Times the correlation calculations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>corr</strong> – numpy array of the local correlation. If reduce is set to False, the output has the same shape as the input maps,
while if reduce is True, the output is reduce by the window size: shape//window_size.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mappy.raster_functions.correlate_maps.correlate_maps_base">
<code class="sig-name descname">correlate_maps_base</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">map1</span></em>, <em class="sig-param"><span class="n">map2</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">window_size</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">fraction_accepted</span><span class="o">=</span><span class="default_value">0.7</span></em>, <em class="sig-param"><span class="n">reduce</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mappy/raster_functions/correlate_maps.html#correlate_maps_base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mappy.raster_functions.correlate_maps.correlate_maps_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes two maps and returning the local correlation between them with the same dimensions as the input maps.
Correlation calculated in a rolling window with the size <cite>window_size</cite>. If either of the input maps contains
a NaN value on a location, the output map will also have a NaN on that location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map1, map2</strong> (<em>array-like</em>) – Input arrays that will be correlated. If not present in dtype <cite>np.float64</cite> it will be converted internally. They
have exatly the same shape and have two dimensions.</p></li>
<li><p><strong>window_size</strong> (<em>int, optional</em>) – Size of the window used for the correlation calculations. It should be bigger than 1, the default is 5.</p></li>
<li><p><strong>fraction_accepted</strong> (<em>float, optional</em>) – Fraction of the window that has to contain not-nans for the function to calculate the correlation. The default
is 0.7.</p></li>
<li><p><strong>reduce</strong> (<em>bool, optional</em>) – Reuse all cells exactly once by setting a stepsize of the same size as window_size. The resulting map will have
the shape: shape/window_size</p></li>
<li><p><strong>verbose ; bool, optional</strong> – Times the correlation calculations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>corr</strong> – numpy array of the local correlation. If reduce is set to False, the output has the same shape as the input maps,
while if reduce is True, the output is reduce by the window size: shape//window_size.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mappy.raster_functions.correlate_maps.correlate_maps_njit">
<code class="sig-name descname">correlate_maps_njit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">map1</span></em>, <em class="sig-param"><span class="n">map2</span></em>, <em class="sig-param"><span class="n">window_size</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">fraction_accepted</span><span class="o">=</span><span class="default_value">0.7</span></em>, <em class="sig-param"><span class="n">reduce</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mappy/raster_functions/correlate_maps.html#correlate_maps_njit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mappy.raster_functions.correlate_maps.correlate_maps_njit" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes two maps and returning the local correlation between them with the same dimensions as the input maps.
Correlation calculated in a rolling window with the size <cite>window_size</cite>. If either of the input maps contains
a NaN value on a location, the output map will also have a NaN on that location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map1, map2</strong> (<em>array-like</em>) – Input arrays that will be correlated. If not present in dtype <cite>np.float64</cite> it will be converted internally. They
have exatly the same shape and have two dimensions.</p></li>
<li><p><strong>window_size</strong> (<em>int, optional</em>) – Size of the window used for the correlation calculations. It should be bigger than 1, the default is 5.</p></li>
<li><p><strong>fraction_accepted</strong> (<em>float, optional</em>) – Fraction of the window that has to contain not-nans for the function to calculate the correlation. The default
is 0.7.</p></li>
<li><p><strong>reduce</strong> (<em>bool, optional</em>) – Reuse all cells exactly once by setting a stepsize of the same size as window_size. The resulting map will have
the shape: shape/window_size</p></li>
<li><p><strong>verbose ; bool, optional</strong> – Times the correlation calculations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>corr</strong> – numpy array of the local correlation. If reduce is set to False, the output has the same shape as the input maps,
while if reduce is True, the output is reduce by the window size: shape//window_size.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Jasper Roebroek

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>