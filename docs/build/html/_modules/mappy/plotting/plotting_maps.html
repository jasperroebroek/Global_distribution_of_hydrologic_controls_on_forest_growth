

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mappy.plotting.plotting_maps &mdash; mappy 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> mappy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">mappy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>mappy.plotting.plotting_maps</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for mappy.plotting.plotting_maps</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">cartopy</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span><span class="p">,</span> <span class="n">Colormap</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Patch</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span><span class="p">,</span> <span class="n">Polygon</span>
<span class="kn">from</span> <span class="nn">mappy.plotting.misc</span> <span class="kn">import</span> <span class="n">_determine_cmap_boundaries</span>
<span class="kn">from</span> <span class="nn">..ndarray_functions.nan_functions</span> <span class="kn">import</span> <span class="n">nanunique</span><span class="p">,</span> <span class="n">nandigitize</span>
<span class="kn">from</span> <span class="nn">..plotting</span> <span class="kn">import</span> <span class="n">add_colorbar</span><span class="p">,</span> <span class="n">cmap_2d</span><span class="p">,</span> <span class="n">cmap_random</span><span class="p">,</span> <span class="n">legend_patches</span>


<div class="viewcode-block" id="plot_map"><a class="viewcode-back" href="../../../mappy.plotting.plotting_maps.html#mappy.plotting.plotting_maps.plot_map">[docs]</a><span class="k">def</span> <span class="nf">plot_map</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;colorbar&quot;</span><span class="p">,</span> <span class="n">clip_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">legend_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pad_fraction</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot rasters in a continuous fashion</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : array-like</span>
<span class="sd">        Input array. Needs to be either 2D or 3D if the third axis contains RGB(A) information</span>
<span class="sd">    bins : array-like, optional</span>
<span class="sd">        List of bins that will be used to create a BoundaryNorm instance to discretise the plotting. This does not work</span>
<span class="sd">        in conjunction with vmin and vmax. Bins in that case `bins` will take the upper hand.  Alternatively a &#39;norm&#39;</span>
<span class="sd">        parameter can be passed on in the have outside control on the behaviour. Note that at least two bins need to be</span>
<span class="sd">        specified.</span>
<span class="sd">    cmap : matplotlib.cmap or str, optional</span>
<span class="sd">        Matplotlib cmap instance or string the will be recognized by matplotlib</span>
<span class="sd">    vmin, vmax : float, optional</span>
<span class="sd">        vmin and vmax parameters for plt.imshow(). This does have no effect in conjunction with bins being provided.</span>
<span class="sd">    legend : {&#39;colorbar&#39;, &#39;legend&#39;, False}, optional</span>
<span class="sd">        Legend type that will be plotted. The &#39;legend&#39; type will only work if bins are specified.</span>
<span class="sd">    clip_legend : bool, optional</span>
<span class="sd">        Clip the legend to the minimum and maximum of bins are provided. If False the colormap will remain intact over</span>
<span class="sd">        the whole provided bins, which potentially lowers contrast a lot, but works great for having a common colorbar</span>
<span class="sd">        for several plots.</span>
<span class="sd">    ax : `matplotlib.Axes`, optional</span>
<span class="sd">        Axes object. If not provided it will be created on the fly.</span>
<span class="sd">    figsize : tuple, optional</span>
<span class="sd">        Matplotlib figsize parameter. Default is (10, 10)</span>
<span class="sd">    legend_kwargs : dict, optional</span>
<span class="sd">        Extra parameters for the colorbar call</span>
<span class="sd">    aspect : float, optional</span>
<span class="sd">        aspact ratio of the colorbar</span>
<span class="sd">    pad_fraction : float, optional</span>
<span class="sd">        pad_fraction between the Axes and the colorbar if generated</span>
<span class="sd">    **kwargs</span>
<span class="sd">        Keyword arguments for plt.imshow()</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When providing a GeoAxes in the &#39;ax&#39; parameter it needs to be noted that the &#39;extent&#39; of the data should be provided</span>
<span class="sd">    if there is not a perfect overlap. If provided to this function it will be handled by **kwargs. The same goes for</span>
<span class="sd">    &#39;transform&#39; if the plotting projection is different than the data projection.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Axes or GeoAxes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input data needs to be 2D or present RGB(A) values on the third axis.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">or</span> <span class="n">m</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="s2">&quot;bool_&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;3D arrays are only acceptable if presenting RGB(A) information&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cartopy</span><span class="o">.</span><span class="n">mpl</span><span class="o">.</span><span class="n">geoaxes</span><span class="o">.</span><span class="n">GeoAxes</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;extent&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;extent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;transform&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;transform&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">projection</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">Colormap</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;cmap not recognized&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">plot_classified_map</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;&lt; </span><span class="si">{bins[0]}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;&gt; </span><span class="si">{bins[1]}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                            <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">legend_kwargs</span><span class="o">=</span><span class="n">legend_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">m</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="s2">&quot;bool_&quot;</span> <span class="ow">and</span> <span class="n">m</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legend_kwargs</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
                <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="n">legend</span> <span class="o">==</span> <span class="s2">&quot;colorbar&quot;</span><span class="p">:</span>
                <span class="n">add_colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="n">aspect</span><span class="p">,</span> <span class="n">pad_fraction</span><span class="o">=</span><span class="n">pad_fraction</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">legend_patches</span><span class="p">,</span> <span class="n">extend</span> <span class="o">=</span> <span class="n">_determine_cmap_boundaries</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                                                            <span class="n">clip_legend</span><span class="o">=</span><span class="n">clip_legend</span><span class="p">)</span>

            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">legend</span> <span class="o">==</span> <span class="s2">&quot;legend&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legend_kwargs</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
                    <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;facecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="s2">&quot;edgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_patches</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">legend</span> <span class="o">==</span> <span class="s2">&quot;colorbar&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legend_kwargs</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
                    <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">cbar</span> <span class="o">=</span> <span class="n">add_colorbar</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">im</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="n">aspect</span><span class="p">,</span> <span class="n">pad_fraction</span><span class="o">=</span><span class="n">pad_fraction</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">m</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">m</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">plot_classified_map</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;False&#39;</span><span class="p">,</span> <span class="s1">&#39;True&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">legend_kwargs</span><span class="o">=</span><span class="n">legend_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
            <span class="n">plot_classified_map</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span>
                                <span class="n">legend_kwargs</span><span class="o">=</span><span class="n">legend_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_classified_map</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;False&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span>
                                <span class="n">legend_kwargs</span><span class="o">=</span><span class="n">legend_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="plot_world"><a class="viewcode-back" href="../../../mappy.plotting.plotting_maps.html#mappy.plotting.plotting_maps.plot_world">[docs]</a><span class="k">def</span> <span class="nf">plot_world</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">box_bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plotting the world. Points to plot should be given in a pandas dataframe with Lat and Lon column. Bounds object of</span>
<span class="sd">    a rasterio file can be plotted with box_bounds parameter.</span>

<span class="sd">    # todo; deprecate</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    points</span>
<span class="sd">        1: [DataFrame]</span>
<span class="sd">            Need to contain the columns &quot;Lat&quot; and &quot;Lon&quot;</span>
<span class="sd">        2: [GeoDataFrame]</span>
<span class="sd">            Contains column with shapely Point geometry</span>
<span class="sd">        3: [list : Point]</span>
<span class="sd">            Contains shapely Points</span>
<span class="sd">    box_bounds : rasterio.bounds</span>
<span class="sd">        bounds from rasterio profile</span>
<span class="sd">    figsize : [tuple : ints]</span>
<span class="sd">        Two ints, passed to the plotting functions based on matplotlib</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># read a small background world map</span>
    <span class="n">world</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">gpd</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s1">&#39;naturalearth_lowres&#39;</span><span class="p">))</span>
    <span class="c1"># plot the background map</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

    <span class="c1"># plot the points if any</span>
    <span class="c1"># !! would be nice to implement a possibility of passing a list/dict</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
            <span class="c1"># add shapely geometry column (Point)</span>
            <span class="n">points</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">Point</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">Lon</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">Lat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># convert to geopandas</span>
            <span class="n">points</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">Point</span><span class="p">,</span> <span class="s2">&quot;List doesn&#39;t contain points&quot;</span>
            <span class="n">points</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">points</span><span class="p">})</span>

        <span class="c1"># plot the points on top of the background map</span>
        <span class="n">points</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

    <span class="c1"># plot a box on the map</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">box_bounds</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="c1"># create a list with the x coordinates of the corners</span>
        <span class="n">box_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">box_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">box_bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">box_bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">box_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="c1"># create a list with the y coordinates of the corners</span>
        <span class="n">box_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">box_bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">box_bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">box_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">box_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="c1"># create a shapely Polygon from those lists</span>
        <span class="n">bounding_box</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">box_x</span><span class="p">,</span> <span class="n">box_y</span><span class="p">))</span>
        <span class="c1"># create a geopandas dataframe with one entry</span>
        <span class="c1"># !! check if this step can be skipped</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">geometry</span><span class="o">=</span><span class="p">[</span><span class="n">bounding_box</span><span class="p">])</span>
        <span class="c1"># plot the box on top of the background map</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">91</span><span class="p">,</span> <span class="mi">91</span><span class="p">])</span>
    <span class="n">t</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">181</span><span class="p">,</span> <span class="mi">181</span><span class="p">])</span>
    <span class="n">t</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="plot_classified_map"><a class="viewcode-back" href="../../../mappy.plotting.plotting_maps.html#mappy.plotting.plotting_maps.plot_classified_map">[docs]</a><span class="k">def</span> <span class="nf">plot_classified_map</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;legend&quot;</span><span class="p">,</span> <span class="n">clip_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;classes&quot;</span><span class="p">,</span> <span class="n">legend_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a map with discrete classes or index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : array</span>
<span class="sd">        input map</span>
<span class="sd">    bins : list, optional</span>
<span class="sd">        list of either bins as used in np.digitize or unique values corresponding to `colors` and `labels`. By default</span>
<span class="sd">        this parameter is not necessary, the unique values are taken from the input map</span>
<span class="sd">    colors : list, optional</span>
<span class="sd">        List of colors in a format understandable by matplotlib. By default random colors are taken</span>
<span class="sd">    cmap : matplotlib cmap or str</span>
<span class="sd">        Can be used to set a colormap when no colors are provided.</span>
<span class="sd">    labels : list, optional</span>
<span class="sd">        list of labels for the different classes. By default the unique values are taken as labels</span>
<span class="sd">    legend : {&#39;legend&#39;, &#39;colorbar&#39;, False}, optional</span>
<span class="sd">        Presence and type of legend. &#39;Legend&#39; wil insert patches, &#39;colorbar&#39; wil insert a colorbar and False will</span>
<span class="sd">        prevent any legend to be printed.</span>
<span class="sd">    clip_legend : bool, optional</span>
<span class="sd">        remove the items from the legend that don&#39;t occur on the map but are passed in</span>
<span class="sd">    ax : axes, optional</span>
<span class="sd">        matplotlib axes to plot the map on. If not given it is created on the fly. A cartopty GeoAxis can be provided.</span>
<span class="sd">    suppress_warnings : bool, optional</span>
<span class="sd">        By default 15 classes is the maximum that can be plotted. If set to True this maximum is removed</span>
<span class="sd">    mode : {&#39;classes&#39;, &#39;index&#39;}</span>
<span class="sd">        &#39;Classes&#39; is used for individual values that can not directly be used as indices</span>
<span class="sd">        &#39;Index&#39; for raters that already contain the exact index for colors and labels lists</span>
<span class="sd">    legend_kwargs : dict, optional</span>
<span class="sd">        kwargs passed into either the legend or colorbar function.</span>
<span class="sd">        A special `legend_title_pad` can be set to create a padding between the colorbar and the title of colorbar,</span>
<span class="sd">        which can be set in these kwargs as `title`. The default `legend_title_pad` is 10.</span>
<span class="sd">    **kwargs : dict, optional</span>
<span class="sd">        kwargs for the plt.imshow command</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When providing a GeoAxes in the &#39;ax&#39; parameter it needs to be noted that the &#39;extent&#39; of the data should be provided</span>
<span class="sd">    if there is not a perfect overlap. If provided to this function it will be handled by **kwargs. The same goes for</span>
<span class="sd">    &#39;transform&#39; if the plotting projection is different from the data projection.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cartopy</span><span class="o">.</span><span class="n">mpl</span><span class="o">.</span><span class="n">geoaxes</span><span class="o">.</span><span class="n">GeoAxes</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;extent&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;extent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;transform&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;transform&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">projection</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;classes&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode not recognized&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;classes&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
        <span class="n">bins</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">15</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">suppress_warnings</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of bins above 15, this creates issues with visibility&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;length of bins and colors don&#39;t match</span><span class="se">\n</span><span class="s2">bins: {len(bins)}</span><span class="se">\n</span><span class="s2">colors: {len(colors)}&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">cmap_random</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;rgb&quot;</span><span class="p">,</span> <span class="n">color_type</span><span class="o">=</span><span class="s2">&quot;pastel&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;length of bins and labels don&#39;t match&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span>
        <span class="n">m_binned</span> <span class="o">=</span> <span class="n">m</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;classes&#39;</span><span class="p">:</span>
        <span class="n">m_binned</span> <span class="o">=</span> <span class="n">nandigitize</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">m_binned_unique</span> <span class="o">=</span> <span class="n">nanunique</span><span class="p">(</span><span class="n">m_binned</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">m_binned_unique</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m_binned_unique</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">num</span><span class="o">=</span><span class="n">m_binned_unique</span><span class="o">.</span><span class="n">size</span><span class="p">))</span> <span class="ow">or</span> \
        <span class="nb">len</span><span class="p">(</span><span class="n">m_binned_unique</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">))</span> <span class="ow">and</span> <span class="n">clip_legend</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">m_binned_unique</span><span class="p">]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">m_binned_unique</span><span class="p">]</span>
        <span class="n">m_binned</span> <span class="o">=</span> <span class="n">nandigitize</span><span class="p">(</span><span class="n">m_binned</span><span class="p">,</span> <span class="n">m_binned_unique</span><span class="p">)</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>

    <span class="n">legend_patches</span> <span class="o">=</span> <span class="n">legend_patches</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>

    <span class="c1"># Plotting</span>
    <span class="k">if</span> <span class="n">clip_legend</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">bins</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">m_binned</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Legend</span>
    <span class="k">if</span> <span class="n">legend</span> <span class="o">==</span> <span class="s2">&quot;legend&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legend_kwargs</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;facecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="s2">&quot;edgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_patches</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">legend</span> <span class="o">==</span> <span class="s2">&quot;colorbar&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legend_kwargs</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">legend_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">legend_title_pad</span> <span class="o">=</span> <span class="n">legend_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;legend_title_pad&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="n">cbar</span> <span class="o">=</span> <span class="n">add_colorbar</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">im</span><span class="p">,</span> <span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>

        <span class="n">N</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">(</span><span class="n">cbar</span><span class="o">.</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">cbar</span><span class="o">.</span><span class="n">vmin</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
        <span class="n">margin</span> <span class="o">=</span> <span class="n">step</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">cbar</span><span class="o">.</span><span class="n">vmin</span> <span class="o">+</span> <span class="n">margin</span><span class="p">,</span> <span class="n">cbar</span><span class="o">.</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">margin</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">N</span><span class="p">))</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">legend_title_pad</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="create_map_cmap_2d"><a class="viewcode-back" href="../../../mappy.plotting.plotting_maps.html#mappy.plotting.plotting_maps.create_map_cmap_2d">[docs]</a><span class="k">def</span> <span class="nf">create_map_cmap_2d</span><span class="p">(</span><span class="n">map1</span><span class="p">,</span> <span class="n">map2</span><span class="p">,</span> <span class="n">bin1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">diverging</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plotting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Combine two maps with a two dimensional legend.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    map1, map2 : array</span>
<span class="sd">        two identically shaped arrays</span>
<span class="sd">    bin1, bin2 : list, optional</span>
<span class="sd">        bins used for digitization with raster_functions.misc.nandigitize().</span>
<span class="sd">    vmin1, vmax1, vmin2, vmax2</span>
<span class="sd">        min and max of both input maps used for plotting (like vmin and vmax in imshow). Ff None, which is the default,</span>
<span class="sd">        they will be calculated from the data. These values are only considered when no bin is passed.</span>
<span class="sd">    cmap : array, optional</span>
<span class="sd">        3D array providing bins for map1 and map2 and RGB colors on the third axis. This can be created with the cmap_2d</span>
<span class="sd">        interface. If not provided it will be created on the fly. If the map is already classified by np.digitize it</span>
<span class="sd">        will be recognized and that specific axis will be split in the number of bins as intended. If not digitized</span>
<span class="sd">        1000 bins will be created, which will be a smooth scale.</span>
<span class="sd">    diverging : bool, optional</span>
<span class="sd">        Use a diverging color scale if cmap is not provided. This means that the center of the 2D color legend will  be</span>
<span class="sd">        white instead of grey to notify divergence. Default is False.</span>
<span class="sd">    plotting : bool, optional</span>
<span class="sd">        plotting the created result</span>
<span class="sd">    show : bool, optional</span>
<span class="sd">        Execute the plt.plot() command</span>
<span class="sd">    ax : Axis, optional</span>
<span class="sd">        matplotlib axes where the plot should be plotted to. If not given a new</span>
<span class="sd">        figure is created, which is the default behaviour.</span>
<span class="sd">    figsize : list, optional</span>
<span class="sd">        Figsize parameter for matplotlib. Default is (10,10)</span>
<span class="sd">    silent : bool, optional</span>
<span class="sd">        Return the created map, which is a 3D numpy array with on the last axis the</span>
<span class="sd">        RGB color components (0-1).</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    map : np.ndarray</span>
<span class="sd">        numpy array containing the newly created map. Dimensionality depends on &#39;cmap&#39; parameter. If none is passed a</span>
<span class="sd">        RGB legend is created, resulting in a 3D array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bin1</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
        <span class="n">map1</span> <span class="o">=</span> <span class="n">nandigitize</span><span class="p">(</span><span class="n">map1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bin1</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bin2</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
        <span class="n">map2</span> <span class="o">=</span> <span class="n">nandigitize</span><span class="p">(</span><span class="n">map2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bin2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">map1</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">map2</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;maps are not of equal shape&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">plotting</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;plotting is a boolean variable&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">diverging</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;diverging is a boolean variable&quot;</span><span class="p">)</span>

    <span class="c1"># copy maps to prevent overwriting problems because a memory locations is send</span>
    <span class="c1"># to the function instead of an array.</span>
    <span class="n">axis0</span> <span class="o">=</span> <span class="n">map1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">axis1</span> <span class="o">=</span> <span class="n">map2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># create a nan mask that will be used to overwrite the final map with nans</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">axis0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">axis1</span><span class="p">))</span>

    <span class="c1"># create lists with the unique values in both maps (nan values filtered out)</span>
    <span class="n">axis0_unique</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">axis0</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">axis0</span><span class="p">)])</span>
    <span class="n">axis1_unique</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">axis1</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">axis1</span><span class="p">)])</span>

    <span class="c1"># Routine to check if input maps are already classified or not.</span>
    <span class="c1"># Output is a list of two boolean values. A map is classified if the unique</span>
    <span class="c1"># values of that map overlap with a linspace instance with the same min,max and</span>
    <span class="c1"># length as the unique values.</span>
    <span class="c1"># for example:</span>
    <span class="c1">#       unique_values = [0,1,2]</span>
    <span class="c1">#       np.linspace(unique_values[0], unique_values[-1], num = unique_values.size)</span>
    <span class="c1">#       &gt; [0,1,2]</span>
    <span class="c1"># these two lists are equal and therefore the map can be seen as classified.</span>
    <span class="n">classified</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">axis0_unique</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis0_unique</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                          <span class="n">num</span><span class="o">=</span><span class="n">axis0_unique</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">axis0_unique</span><span class="p">),</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">axis1_unique</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis1_unique</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                          <span class="n">num</span><span class="o">=</span><span class="n">axis1_unique</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">axis1_unique</span><span class="p">)]</span>

    <span class="c1"># If cmap is not provided it is created here. </span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cmap:&quot;</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">axis0_unique</span><span class="o">.</span><span class="n">size</span> <span class="k">if</span> <span class="n">classified</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="mi">1000</span><span class="p">,</span>
             <span class="n">axis1_unique</span><span class="o">.</span><span class="n">size</span> <span class="k">if</span> <span class="n">classified</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="mi">1000</span><span class="p">]</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap_2d</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">l</span><span class="p">,</span> <span class="n">plotting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">diverging</span><span class="o">=</span><span class="n">diverging</span><span class="p">)</span>

    <span class="n">old_settings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>  <span class="c1"># silence all numpy warnings</span>

    <span class="c1"># Routines to create a vector containing the bins for both input maps</span>
    <span class="c1"># called axisx_space.</span>
    <span class="k">if</span> <span class="n">classified</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="c1"># if axis0_unique.size != cmap.shape[0]:</span>
        <span class="c1">#    raise IndexError(&quot;Shape of cmap and the first map don&#39;t match&quot;)</span>
        <span class="n">axis0_space</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">axis0_unique</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">vmin1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">axis0</span><span class="p">[</span><span class="n">axis0</span> <span class="o">&lt;</span> <span class="n">vmin1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmin1</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">vmax1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">axis0</span><span class="p">[</span><span class="n">axis0</span> <span class="o">&gt;</span> <span class="n">vmax1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmax1</span>
        <span class="n">axis0_space</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">axis0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">axis0</span><span class="p">),</span>
                                  <span class="n">num</span><span class="o">=</span><span class="n">cmap</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">classified</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="c1"># if axis1_unique.size != cmap.shape[1]:</span>
        <span class="c1">#    raise IndexError(&quot;Shape of cmap and the second map don&#39;t match&quot;)</span>
        <span class="n">axis1_space</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">axis1_unique</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vmin2</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">axis1</span><span class="p">[</span><span class="n">axis1</span> <span class="o">&lt;</span> <span class="n">vmin2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmin2</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">vmax2</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">axis1</span><span class="p">[</span><span class="n">axis1</span> <span class="o">&gt;</span> <span class="n">vmax2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmax2</span>
        <span class="n">axis1_space</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">axis1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">axis1</span><span class="p">),</span>
                                  <span class="n">num</span><span class="o">=</span><span class="n">cmap</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">old_settings</span><span class="p">)</span>  <span class="c1"># reset to default</span>

    <span class="c1"># remove nans with temporary value that will be replaced based on the mask variable</span>
    <span class="n">axis0</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">axis0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">axis1</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">axis1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># digitize both maps</span>
    <span class="n">axis0_digitized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">axis0</span><span class="p">,</span> <span class="n">axis0_space</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">axis1_digitized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">axis1</span><span class="p">,</span> <span class="n">axis1_space</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c1"># combine maps with cmap</span>
    <span class="n">digitized_map</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">[</span><span class="n">axis0_digitized</span><span class="p">,</span> <span class="n">axis1_digitized</span><span class="p">]</span>
    <span class="c1"># set the nan values to white</span>

    <span class="k">if</span> <span class="n">cmap</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">digitized_map</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">cmap</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">digitized_map</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># plotting routine</span>
    <span class="k">if</span> <span class="n">plotting</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">digitized_map</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">digitized_map</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Jasper Roebroek

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>